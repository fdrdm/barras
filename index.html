<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Barras semanales con capacidad real</title>
  <style>
    body {
      background: linear-gradient(180deg, #0f172a 0%, #1e293b 100%);
      color: #f1f5f9;
      font-family: 'Inter', system-ui, sans-serif;
      padding: 50px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 40px;
    }

    h1 {
      font-size: 26px;
      text-align: center;
      color: #e2e8f0;
      margin-bottom: -10px;
    }

    .subtitulo {
      font-size: 15px;
      color: #94a3b8;
      margin-top: -10px;
      margin-bottom: 20px;
    }

    .zona-superior {
      display: flex;
      align-items: center;
      gap: 80px;
    }

    .cubos {
      display: flex;
      gap: 12px;
      justify-content: center;
    }

    .cubo {
      height: 60px;
      border-radius: 8px;
      cursor: grab;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-weight: 600;
      font-size: 14px;
      user-select: none;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      transition: transform 0.15s ease, box-shadow 0.15s ease;
    }

    .cubo:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 16px rgba(0,0,0,0.4);
    }

    .idea { width: 25px; background: #3b82f6; }
    .outline { width: 54px; background: #22c55e; }
    .script { width: 110px; background: #f97316; }

    .cubo:active { opacity: 0.7; cursor: grabbing; }

    .barras {
      display: flex;
      flex-direction: column;
      gap: 45px;
      align-items: center;
    }

    .barra {
      background: #1e293b;
      border-radius: 14px;
      height: 80px;
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 8px;
      position: relative;
      flex-wrap: wrap;
      box-shadow: inset 0 0 8px rgba(0,0,0,0.3);
      transition: box-shadow 0.2s ease, outline 0.2s ease;
    }

    .barra:hover {
      box-shadow: inset 0 0 10px rgba(56,189,248,0.4);
    }

    .titulo-barra {
      position: absolute;
      top: -26px;
      left: 10px;
      font-size: 15px;
      color: #cbd5e1;
      font-weight: 500;
    }

    .barra.over { outline: 3px dashed #38bdf8; }
    #trash.over { outline: 3px dashed #ef4444; }

    #trash {
      width: 90px;
      height: 90px;
      background: #1e293b;
      border-radius: 14px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-size: 32px;
      cursor: pointer;
      transition: background 0.25s, transform 0.15s;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }

    #trash span {
      font-size: 12px;
      color: #94a3b8;
      margin-top: 4px;
    }

    #trash:hover { 
      background: #334155; 
      transform: translateY(-3px);
    }

    .info {
      font-size: 13px;
      color: #94a3b8;
      margin-top: -10px;
    }

    /* Escala visual de las barras seg√∫n capacidad */
    #basic { width: calc(8 * 30px + 40px); }
    #plus  { width: calc(16 * 30px + 40px); }
    #pro   { width: calc(24 * 30px + 40px); }
  </style>
</head>
<body>
  <h1>Barras de producci√≥n por semana</h1>
  <div class="subtitulo">(Arrastr√° cubos a las barras o al tacho para eliminar)</div>

  <div class="zona-superior">
    <div>
      <div class="cubos" id="zonaCubos">
        <div class="cubo idea plantilla" draggable="true" data-size="1" data-type="idea">Idea</div>
        <div class="cubo outline plantilla" draggable="true" data-size="2" data-type="outline">Outline</div>
        <div class="cubo script plantilla" draggable="true" data-size="4" data-type="script">Script</div>
      </div>
      <div class="info">(Idea = 1x1, Outline = 1x2, Script = 1x4)</div>
    </div>
    <div id="trash">üóëÔ∏è<span>Eliminar</span></div>
  </div>

  <div class="barras">
    <div class="barra" id="basic" data-capacidad="8">
      <span class="titulo-barra">Basic ‚Äî 8 Ideas / 4 Outlines / 2 Scripts / MIX</span>
    </div>
    <div class="barra" id="plus" data-capacidad="16">
      <span class="titulo-barra">Plus ‚Äî 16 Ideas / 8 Outlines / 4 Scripts / MIX</span>
    </div>
    <div class="barra" id="pro" data-capacidad="24">
      <span class="titulo-barra">Pro ‚Äî 24 Ideas / 12 Outlines / 6 Scripts / MIX</span>
    </div>
  </div>

  <script>
    const barras = document.querySelectorAll('.barra');
    const trash = document.getElementById('trash');

    document.addEventListener('dragstart', e => {
      if (e.target.classList.contains('cubo')) {
        e.dataTransfer.setData('type', e.target.dataset.type);
        e.dataTransfer.setData('size', e.target.dataset.size);
        e.dataTransfer.setData('isTemplate', e.target.classList.contains('plantilla'));
        e.target.classList.add('dragging');
      }
    });

    document.addEventListener('dragend', e => {
      if (e.target.classList.contains('cubo')) e.target.classList.remove('dragging');
    });

    function setupDropZone(zone, isBarra = false) {
      zone.addEventListener('dragover', e => { e.preventDefault(); zone.classList.add('over'); });
      zone.addEventListener('dragleave', () => zone.classList.remove('over'));

      zone.addEventListener('drop', e => {
        e.preventDefault();
        zone.classList.remove('over');
        const type = e.dataTransfer.getData('type');
        const size = parseInt(e.dataTransfer.getData('size'));
        const isTemplate = e.dataTransfer.getData('isTemplate') === 'true';
        const dragging = document.querySelector('.dragging');

        if (isBarra) {
          const capacidad = parseInt(zone.dataset.capacidad);
          const ocupado = Array.from(zone.children)
            .filter(c => c.classList.contains('cubo'))
            .reduce((sum, c) => sum + parseInt(c.dataset.size), 0);

          if (ocupado + size <= capacidad) {
            let nuevo;
            if (isTemplate) {
              nuevo = document.createElement('div');
              nuevo.className = `cubo ${type}`;
              nuevo.textContent = type.charAt(0).toUpperCase() + type.slice(1);
              nuevo.dataset.type = type;
              nuevo.dataset.size = size;
              nuevo.draggable = true;
            } else {
              nuevo = dragging;
            }
            zone.appendChild(nuevo);
          } else {
            alert('‚ùå No hay espacio suficiente en esta barra');
          }
        } else if (zone.id === 'trash') {
          if (dragging && dragging.parentElement.classList.contains('barra')) {
            dragging.remove();
          }
        }
      });
    }

    barras.forEach(barra => setupDropZone(barra, true));
    setupDropZone(trash, false);
  </script>
</body>
</html>

